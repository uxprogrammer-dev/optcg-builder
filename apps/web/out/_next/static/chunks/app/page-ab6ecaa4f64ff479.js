(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7746:function(e,s,a){Promise.resolve().then(a.bind(a,2324))},2324:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return g}});var t,l=a(1674),r=a(6655),i=a(2608),n=a(925),c=a(5504);let d=n.Z.create({baseURL:null!==(t=c.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==t?t:"/api"});async function o(e){let{data:s}=await d.post("/ai/leaders",{prompt:e});return s}async function x(e,s){let{data:a}=await d.post("/decks",{prompt:e,leaderCardId:s});return a}async function m(e){let{data:s}=await d.get("/decks/".concat(e,"/download"),{responseType:"arraybuffer"});return new Blob([s],{type:"application/zip"})}var u=a(8618),h=a(4115);function p(e){var s;let{leader:a,isSelected:t,onSelect:r}=e;return(0,l.jsxs)("button",{type:"button",onClick:()=>r(a),className:(0,h.Z)("flex flex-col overflow-hidden rounded-xl border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-400",t?"border-primary-500 shadow-lg shadow-primary-900/40":"border-slate-800"),children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(u.default,{src:a.card.imageUrl,alt:a.card.name,width:300,height:420,className:"h-72 w-full object-cover",priority:!0}),(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-slate-950/80"}),(0,l.jsxs)("div",{className:"absolute bottom-0 p-4 text-left",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:a.card.name}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-200",children:null!==(s=a.strategySummary)&&void 0!==s?s:a.rationale})]})]}),(0,l.jsxs)("div",{className:"bg-slate-900 p-4 text-left text-sm text-slate-300",children:[(0,l.jsx)("p",{className:"line-clamp-4 leading-snug",children:a.rationale}),(0,l.jsx)("p",{className:"mt-2 text-xs uppercase tracking-wide text-primary-300",children:a.card.id})]})]})}function f(e){let{deckCard:s}=e;return(0,l.jsxs)("div",{className:"flex flex-col overflow-hidden rounded-xl border border-slate-800 bg-slate-950/60 shadow-sm shadow-slate-900/40",children:[(0,l.jsx)("div",{className:"relative h-48 w-full overflow-hidden",children:(0,l.jsx)(u.default,{src:s.card.imageUrl,alt:s.card.name,fill:!0,sizes:"(max-width: 768px) 50vw, 200px",className:"object-cover"})}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-2 p-4 text-sm text-slate-200",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-base font-semibold text-white",children:s.card.name}),(0,l.jsx)("p",{className:"text-xs uppercase tracking-wide text-primary-300",children:s.card.id})]}),(0,l.jsx)("p",{className:"line-clamp-3 text-xs text-slate-300",children:s.rationale}),(0,l.jsxs)("div",{className:"mt-auto flex items-center justify-between text-xs text-slate-400",children:[(0,l.jsxs)("span",{children:["Role: ",s.role]}),(0,l.jsxs)("span",{className:"font-semibold text-primary-300",children:["x",s.quantity]})]})]})]})}function g(){let[e,s]=(0,r.useState)(""),[a,t]=(0,r.useState)([]),[n,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[h,g]=(0,r.useState)(null),b=(0,i.D)({mutationFn:async e=>(g(null),o(e)),onSuccess:e=>{t(e.leaders),c(null),u(null)},onError:e=>{console.error(e),g("Failed to generate leader suggestions. Please try again.")}}),v=(0,i.D)({mutationFn:async s=>(g(null),x(e,s.card.id)),onSuccess:e=>{u(e)},onError:e=>{console.error(e),g("Failed to build deck. Please choose another leader or try again.")}}),w=(0,r.useMemo)(()=>{var e;return null!==(e=null==d?void 0:d.cards.reduce((e,s)=>e+s.quantity,0))&&void 0!==e?e:0},[d]),j=b.isPending||v.isPending,y=e=>{c(e),u(null),v.mutate(e)},N=async()=>{if(d)try{let e=await m(d.deckId),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="optcg-deck-".concat(d.deckId,".zip"),document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(s)}catch(e){console.error(e),g("Unable to download deck images. Please try again.")}};return(0,l.jsxs)("main",{className:"mx-auto flex min-h-screen w-full max-w-6xl flex-col gap-10 px-6 py-12",children:[(0,l.jsxs)("header",{className:"space-y-4 text-center",children:[(0,l.jsx)("p",{className:"text-sm uppercase tracking-[0.4em] text-primary-400",children:"One Piece TCG"}),(0,l.jsx)("h1",{className:"text-4xl font-bold text-white md:text-5xl",children:"AI-Powered Deck Builder"}),(0,l.jsx)("p",{className:"mx-auto max-w-3xl text-base text-slate-300 md:text-lg",children:"Describe the strategy, colors, or characters you want to build around. We will suggest competitive leaders, craft a deck list, show live card images, and let you download them in a single archive."})]}),(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-950/60 p-6 shadow-xl shadow-slate-900/40",children:[(0,l.jsxs)("form",{className:"flex flex-col gap-4 md:flex-row",onSubmit:s=>{if(s.preventDefault(),!e.trim()){g("Please provide a prompt describing your desired deck.");return}b.mutate(e.trim())},children:[(0,l.jsxs)("label",{className:"flex-1",children:[(0,l.jsx)("span",{className:"sr-only",children:"Deck prompt"}),(0,l.jsx)("textarea",{className:"h-28 w-full resize-none rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 text-base text-white shadow-inner shadow-slate-900/50 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 md:h-24",placeholder:"Example: Aggressive red/green Straw Hat deck focusing on Rush characters and DON ramp.",value:e,onChange:e=>s(e.target.value),disabled:b.isPending})]}),(0,l.jsx)("button",{type:"submit",className:"h-12 rounded-xl bg-primary-500 px-6 text-sm font-semibold uppercase tracking-wide text-white shadow-lg shadow-primary-900/60 transition hover:bg-primary-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-200 disabled:cursor-not-allowed disabled:bg-primary-700",disabled:b.isPending,children:b.isPending?"Generating...":"Suggest Leaders"})]}),h&&(0,l.jsx)("p",{className:"mt-3 text-sm text-rose-400",children:h})]}),a.length>0&&(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Choose Your Leader"}),j&&(0,l.jsx)("span",{className:"text-sm text-slate-400",children:"Working on it..."})]}),(0,l.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:a.map(e=>(0,l.jsx)(p,{leader:e,isSelected:e.card.id===(null==n?void 0:n.card.id),onSelect:y},e.card.id))})]}),d&&(0,l.jsxs)("section",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Deck List"}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:[d.summary," â€¢ ",w," cards"]})]}),(0,l.jsx)("button",{onClick:N,className:"inline-flex items-center gap-2 rounded-xl border border-primary-500 px-4 py-2 text-sm font-semibold text-primary-300 transition hover:bg-primary-500/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-200",children:"Download Images Zip"})]}),(0,l.jsx)("div",{className:"grid gap-5 md:grid-cols-2 lg:grid-cols-3",children:d.cards.map((e,s)=>(0,l.jsx)(f,{deckCard:e},"".concat(e.card.id,"-").concat(s)))})]})]})}}},function(e){e.O(0,[592,450,293,997,744],function(){return e(e.s=7746)}),_N_E=e.O()}]);